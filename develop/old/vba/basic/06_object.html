<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>6. Excel对象 | 任何一种技艺达到完美 都会令人无法抗拒</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.995160dc.css" as="style"><link rel="preload" href="/assets/js/app.e981111c.js" as="script"><link rel="preload" href="/assets/js/2.d1d67354.js" as="script"><link rel="preload" href="/assets/js/22.69cad544.js" as="script"><link rel="prefetch" href="/assets/js/10.45fe16c6.js"><link rel="prefetch" href="/assets/js/11.2866746f.js"><link rel="prefetch" href="/assets/js/12.61a7e1c4.js"><link rel="prefetch" href="/assets/js/13.ef010414.js"><link rel="prefetch" href="/assets/js/14.c35ddd2d.js"><link rel="prefetch" href="/assets/js/15.5021937c.js"><link rel="prefetch" href="/assets/js/16.62329fb0.js"><link rel="prefetch" href="/assets/js/17.8db5bcb7.js"><link rel="prefetch" href="/assets/js/18.fee441d3.js"><link rel="prefetch" href="/assets/js/19.5196d372.js"><link rel="prefetch" href="/assets/js/20.22d8108d.js"><link rel="prefetch" href="/assets/js/21.2d60308f.js"><link rel="prefetch" href="/assets/js/23.e0a43f22.js"><link rel="prefetch" href="/assets/js/24.9d17b74f.js"><link rel="prefetch" href="/assets/js/25.816df3dd.js"><link rel="prefetch" href="/assets/js/26.c52c0e4e.js"><link rel="prefetch" href="/assets/js/27.33844c1c.js"><link rel="prefetch" href="/assets/js/28.7b536ae8.js"><link rel="prefetch" href="/assets/js/29.dd8d4828.js"><link rel="prefetch" href="/assets/js/3.f77163ec.js"><link rel="prefetch" href="/assets/js/30.ba2120b4.js"><link rel="prefetch" href="/assets/js/31.dc34ca7d.js"><link rel="prefetch" href="/assets/js/32.2d3be3a9.js"><link rel="prefetch" href="/assets/js/33.d3898afb.js"><link rel="prefetch" href="/assets/js/34.37564125.js"><link rel="prefetch" href="/assets/js/35.25aaa2b2.js"><link rel="prefetch" href="/assets/js/36.361565f5.js"><link rel="prefetch" href="/assets/js/37.effcfe23.js"><link rel="prefetch" href="/assets/js/38.936d52dd.js"><link rel="prefetch" href="/assets/js/39.76836af5.js"><link rel="prefetch" href="/assets/js/4.4a616a47.js"><link rel="prefetch" href="/assets/js/40.679ca5e8.js"><link rel="prefetch" href="/assets/js/41.f51931c2.js"><link rel="prefetch" href="/assets/js/42.63f8e76c.js"><link rel="prefetch" href="/assets/js/43.ab6a7423.js"><link rel="prefetch" href="/assets/js/44.d88ba3e5.js"><link rel="prefetch" href="/assets/js/5.04bba5d3.js"><link rel="prefetch" href="/assets/js/6.05dd84d7.js"><link rel="prefetch" href="/assets/js/7.1266bbbb.js"><link rel="prefetch" href="/assets/js/8.1b767c1a.js"><link rel="prefetch" href="/assets/js/9.a0ed9595.js">
    <link rel="stylesheet" href="/assets/css/0.styles.995160dc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">任何一种技艺达到完美 都会令人无法抗拒</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/innerpeace/" class="nav-link">
  平和
</a></div><div class="nav-item"><a href="/develop/" class="nav-link router-link-active">
  猿起
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于菜单" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">
  关于
</a></li><li class="dropdown-item"><!----> <a href="/about/favirate.html" class="nav-link">
  收藏夹
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="http://www.sunjiashu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  哪一站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/innerpeace/" class="nav-link">
  平和
</a></div><div class="nav-item"><a href="/develop/" class="nav-link router-link-active">
  猿起
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于菜单" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">
  关于
</a></li><li class="dropdown-item"><!----> <a href="/about/favirate.html" class="nav-link">
  收藏夹
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="http://www.sunjiashu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  哪一站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/develop/" aria-current="page" class="sidebar-link">猿起</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GoLang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ThreeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_6-excel对象"><a href="#_6-excel对象" class="header-anchor">#</a> 6. Excel对象</h1> <h2 id="_6-1-集合"><a href="#_6-1-集合" class="header-anchor">#</a> 6.1 集合</h2> <h3 id="_6-1-1-集合对象"><a href="#_6-1-1-集合对象" class="header-anchor">#</a> 6.1.1 集合对象</h3> <blockquote><p>Excel中有很多集合，代表一组相同的对象，例如：</p> <ul><li>Axes : 图表中所有坐标轴对象的集合</li> <li>Workbooks : 所有打开的工作簿的集合</li> <li>等等</li></ul></blockquote> <h3 id="_6-1-2-集合引用"><a href="#_6-1-2-集合引用" class="header-anchor">#</a> 6.1.2 集合引用</h3> <blockquote><p>用法：</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>集合(&quot;对象名称&quot;) 或者 集合(对象索引)
</code></pre></div><blockquote><p>例：</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Worksheets(&quot;sheetBS&quot;)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Worksheets(1)
</code></pre></div><h3 id="_6-1-3-集合属性、集合方法"><a href="#_6-1-3-集合属性、集合方法" class="header-anchor">#</a> 6.1.3 集合属性、集合方法</h3> <blockquote><p>Count属性<br>
Item方法<br>
Add方法</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Dim cnt As Integer
cnt = ActiveWorkbook.Worksheets.Count
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Dim wksheet As Object
Dim n As Integer
n = 2
Set wksheet = ActiveWorkbook.WorkSheets.Item(n)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Dim newSheet As Object
Set newSheet = ActiveWorkbook.WorkSheets.Add(&quot;sheetBeyond&quot;)
</code></pre></div><h2 id="_6-2-excel对象"><a href="#_6-2-excel对象" class="header-anchor">#</a> 6.2 Excel对象</h2> <blockquote><p>可在VBE中使用对象浏览器(F2)查看对象成员</p></blockquote> <h3 id="_6-2-1-application对象"><a href="#_6-2-1-application对象" class="header-anchor">#</a> 6.2.1 Application对象</h3> <blockquote><p>Application对象即Excel应用程序对象，该对象包括</p></blockquote> <blockquote><ul><li>应用程序范围的设置和选项</li> <li>返回顶级对象的方法，如ActiveSheet等</li></ul></blockquote> <h3 id="_6-2-2-workbook对象"><a href="#_6-2-2-workbook对象" class="header-anchor">#</a> 6.2.2 Workbook对象</h3> <blockquote><p>Workbook对象对应一个Excel工作簿
Workbook对象是Workbooks集合的成员
ThisWorkbook即运行VBA的工作簿，大多数情况是活动工作簿</p></blockquote> <h3 id="_6-2-3-worksheet对象"><a href="#_6-2-3-worksheet对象" class="header-anchor">#</a> 6.2.3 Worksheet对象</h3> <blockquote><p>Worksheet对象对应一个工作表
Worksheet对象是Worksheets集合的成员，也是Sheets集合的成员</p></blockquote> <h3 id="_6-2-4-range对象"><a href="#_6-2-4-range对象" class="header-anchor">#</a> 6.2.4 Range对象</h3> <blockquote><p>Range为单元格对象，代表某一单元格、某一行、某一列、某一区域(连续或非连续)，或某一三维区域</p></blockquote> <blockquote><p>返回Range对象的属性和方法 ：</p> <ul><li>Worksheet对象的Range属性</li> <li>Worksheet对象的Cells属性</li> <li>Offset属性 : 已有Range对象的偏移区域</li> <li>Union方法 : 两个或多个区域的合并区域</li></ul></blockquote> <h2 id="_6-3-applcation对象详细"><a href="#_6-3-applcation对象详细" class="header-anchor">#</a> 6.3 Applcation对象详细</h2> <h3 id="_6-3-1-属性"><a href="#_6-3-1-属性" class="header-anchor">#</a> 6.3.1 属性</h3> <blockquote><p>Caption : 返回或设置Excel应用程序标题栏的内容<br>
Cursor : 返回或设置鼠标指针状态<br>
CellDragAndDrop : False则禁止拖动单元格
DisplayAlerts : True则显示警告信息<br>
DisplayFormulaBar : True则显示编辑栏<br>
DiplayScrollBars : True则在所有工作簿中显示滚动条<br>
DisplayStatusBar : True则显示状栏<br>
RecentFiles : 显示最近使用的文档<br>
ScreenUpdating : True则开启屏幕更新<br>
StatusBar : 返回或设置状态栏中的文字<br>
Visible : 返回或设置Excel对象是否可见<br>
WindowState : 返回或设置窗口的状态</p></blockquote> <blockquote><p>ActiveCell : 活动单元格<br>
ActiveChart : 活动图表<br>
ActiveSheet : 活动工作簿中的活动工作表<br>
ActiveWindow : 活动窗口<br>
ActiveWorkbook : 活动工作簿<br>
Cells : Range对象，可指定行和列<br>
Selection : 活动窗口中选中的对象<br>
Sheets : 活动工作簿中的所有工作表<br>
Workbooks : 所有打开的工作簿<br>
WorksheetFunction : 在VBA中调用Excel函数的容器</p></blockquote> <h3 id="_6-3-2-方法"><a href="#_6-3-2-方法" class="header-anchor">#</a> 6.3.2 方法</h3> <blockquote><p>Calculate : 计算指定区域中的单元格<br>
Evaluate : 将一个Excel名称转换为一个对象或一个值<br>
Quit : 退出Excel程序<br>
OnKey : 自定义功能键
OnTime : 在特定时间后执行一个过程<br>
SendKeys : 模拟键盘输入<br>
Undo : 撤销最后一次操作，不能撤销VBA执行的处理<br>
Union : 取得两个或多个区域的合并区域</p></blockquote> <h3 id="_6-3-3-事件"><a href="#_6-3-3-事件" class="header-anchor">#</a> 6.3.3 事件</h3> <blockquote><p>NewWorkbokk : 新建工作簿时触发<br>
SheetAcitve : 激活任何工作表时触发<br>
SheetBeforeDoubleClick : 双击任何工作表时触发，在实际双击操作前触发<br>
SheetChange : 用户或外部链接更改了任何工作表中的单元格时触发<br>
SheetDeactive : 任何工作表被停用时触发<br>
WindowActive : 工作簿被激活时触发<br>
WindowDeacitve : 任何工作簿被激活时触发<br>
WindowResize : 任何工作簿窗口调整大小时触发<br>
WorkbookActive : 激活任何工作簿时触发<br>
WorkbookBeforeClose : 任何打开的工作簿关闭前触发<br>
WorkbookBeforeSave : 保存任何工作簿之前触发<br>
WorkbookNewSheet : 在工作簿中新建工作表时触发<br>
WorkbookOpen : 打开工作簿时触发</p></blockquote> <h3 id="_6-3-4-实例"><a href="#_6-3-4-实例" class="header-anchor">#</a> 6.3.4 实例</h3> <blockquote><p>鼠标指针</p> <ul><li>xlDefault : 默认指针</li> <li>xlNorthwestArrow : 西北向箭头指针</li> <li>xlWait : 沙漏型指针</li> <li>xlIBeam : I型指针</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  Application.Cursor = xlWait
  ...
  Application.Cursor = xlDefault
End Sub
</code></pre></div><blockquote><p>屏幕刷新</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  Application.ScreenUpdating = False  '不会实时显示处理中的画面改变
  ...
  Application.ScreenUpdating = True  '实时显示处理中的画面改变
  ...
End Sub
</code></pre></div><blockquote><p>DisplayAlerts控制警告信息</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  Application.DisplayAlerts = False  '不会显示警告信息对话框
  ...
  Application.DisplayAlerts = True  '显示警告信息对话框
  ...
End Sub
</code></pre></div><blockquote><p>RecentsFiles显示最近使用的文档</p> <ul><li>Maximum : 返回或设置最近使用文件列表的文件数上限(0-9)</li> <li>Count : 最近使用文件列表中文件的数量</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
	Dim f As RecentFile
	
	For Each f In Application.RecentFiles
	  Debug.Pring &quot;Recent File Name : &quot; &amp; f.Name
	Next
End Sub
</code></pre></div><blockquote><p>用SendKeys方法模拟键盘输入</p> <ul><li>Keys : 以文本形式发送给应用程序的按键或组合键(Ctrl/Alt/Shift)<br>
~ ：表示Enter键
详细可参照帮助</li> <li>Wait : True则等处理完按键后将控件返回给VBA，False则不等待继续运行VBA</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Application.SendKeys(Keys, Wait)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
	Dim valRtn As Double
	valRtn = Shell(&quot;NOTEPAD.EXE&quot;, 1)  '打开记事本
	AppActivate valRtn
	Application.SendKeys &quot;~&quot;, True  '发送Enter回车
	Application.SendKeys &quot;Beyond Warrior&quot;, True  '输入文本Beyond Warrior
End Sub
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>'激活选项卡
'激活 开始 选项卡(Alt + H)
Appliction.SendKeys(&quot;%h&quot;)
'上述方法会显示快捷键提示, 可再按F6隐藏提示, 使用激活 开始 选项卡
Application.SendKeys(&quot;&amp;h{F6}&quot;) 
</code></pre></div><blockquote><p>OnTime定时执行</p> <ul><li>撤销定时运行需要将Schedule参数设置为False</li> <li>如果找不到指定的过程会报错</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>'20秒后执行过程testSub
Application.OnTime Now + TimeValue(&quot;00:00:20&quot;), &quot;testSub&quot;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>'晚上10点执行过程shutdown
Application.OnTime TimeValue(&quot;22:00:00&quot;), &quot;shutdown&quot;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>'撤销晚上10点执行过程shutdown
Application.OnTime EarliestTime:=TimeValue(&quot;22:00:00&quot;), Procedure:=&quot;shutdown&quot;, Schedule:=False
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>'整点报时
Sub showHour()
  Application.OnTime EarliestTime:=TimeSerial((Hour(Now) + 1) Mod 24, 0, 0), Procedure:=&quot;showHour&quot;
  MsgBox &quot;Now is &quot; &amp; Hour(now) &amp; &quot; hour.&quot;
End Sub
</code></pre></div><blockquote><p>OnKey自定义功能键</p> <ul><li>Key : 按键的字符串，与SendKeys相同</li> <li>Procedure : 要执行的过程名称的字符串，为空则不执行任何操作。省略则恢复Excel的默认设置</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Application.OnKey(Key, Procedure)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  ' Alt + .执行subBeyond过程
  Application.OnKey &quot;%.&quot;, &quot;subBeyond&quot;
  ' Alt + .不执行任何操作
  Application.OnKey &quot;%.&quot;, &quot;&quot;
  ' 取消组合键Alt + .
  Application.OnKey &quot;%.&quot;
End Sub
</code></pre></div><blockquote><p>WorksheetFunction调用内置函数</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  Dim rng As Range
  Dim sum As Integer
  Set rng = ActiveSheet.Range(&quot;B2:D12&quot;)
  sum = Application.WorksheetFunction.Sum(rng)
End Sub
</code></pre></div><ul><li>WorksheetFunction.CountIf计算区域里满足条件的单元格的个数</li></ul> <blockquote><p>Goto跳转<br>
Goto可以选择什么问题工作打开工作簿中的任意区域，该工作簿未处于活动状态时，则激活。该方法的Scroll属性，可让窗口滚动到指定位置</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
 Application.Goto Reference:=Worksheets(&quot;sheetBS&quot;).Range(&quot;B9:S12&quot;), Scroll:=True
End Sub
</code></pre></div><blockquote><p>Union合并单元格</p> <ul><li>至少先择两个Range合并，最多可以合并30个Range</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Application.Union(rng1, rng2, ..., rng30)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Sub testSub()
  Application.Union(Range(&quot;B9:C12&quot;), Range(&quot;S10:V:20&quot;))

End Sub
</code></pre></div><blockquote><p>GetOpenFilename打开对话框打开文件</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Appliction.GetOpenFilename(FileFilter, FilterIndex, Title, ButtonText, MultiSelect)
</code></pre></div><blockquote><p>Application事件</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>'WorkbookBeforeSave事件
Private Sub App_WorkbookBeforeSave(ByVal wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)

End Sub
</code></pre></div><h2 id="_6-4-workbook对象详细"><a href="#_6-4-workbook对象详细" class="header-anchor">#</a> 6.4 Workbook对象详细</h2> <h3 id="_6-4-1-属性"><a href="#_6-4-1-属性" class="header-anchor">#</a> 6.4.1 属性</h3> <blockquote><p>AcitveSheet : 返回活动的工作表，没有则返回Nothing<br>
Application : 返回Excel程序<br>
Charts : 返回工作簿中所有图表工作簿<br>
BuiltinDocumentProperties : 内置文档属性集合<br>
DocumentProperties : 文档属性集合
FullName : 返回对象名称(包括路径)<br>
Name : 返回工作簿名称(不含路径)<br>
Names : 返回所有名称对象<br>
Password : 返回工作簿密码(打开时用)<br>
Path : 返回应用程序的完整路径<br>
ReadOnly : 返回工作簿是否以只读方式打开<br>
Saved : 上次修改已保存，返回True;未保存返回False<br>
Sheets : 返回指定工作簿中的所有工作表的集合<br>
WorkSheets : 返回指定工作簿中的所有工作表的集合<br>
Window : 返回指定工作簿中的所有窗口</p></blockquote> <h3 id="_6-4-2-方法"><a href="#_6-4-2-方法" class="header-anchor">#</a> 6.4.2 方法</h3> <blockquote><p>Activate : 激活工作簿相关的第一个窗口<br>
ChangeFileAccess : 更改工作簿的访问权限<br>
Close : 关闭Workbook对象<br>
Protect : 保护工作簿不被修改<br>
Save : 保存工作簿的修改<br>
SaveAs : 工作簿另存为<br>
SaveCopyAs : 工作簿副本另存为<br>
Unprotect : 对于受保护的工作簿或工作表， 取消工作簿或工作表的保护</p></blockquote> <h3 id="_6-4-3-事件"><a href="#_6-4-3-事件" class="header-anchor">#</a> 6.4.3 事件</h3> <blockquote><p>BeforeClose : 关闭工作簿前触发，若发生更改，在询问是否保存前触发<br>
BeforePrint : 打印前触发<br>
NewSheet : 新建工作表触发<br>
Open : 打开工作簿触发<br>
SheetActivate : 激活任何工作表时触发<br>
SheetDeactivate : 停用任何工作表时触发<br>
WindowActivate : 工作簿窗口激活时触发<br>
WindowDeacitvate : 停用任何工作簿窗口时触发<br>
WindowResize : 任何工作簿窗口调整大小时触发</p></blockquote> <h3 id="_6-4-4-workbooks集合"><a href="#_6-4-4-workbooks集合" class="header-anchor">#</a> 6.4.4 Workbooks集合</h3> <blockquote><p>Add新建工作簿</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Workbooks.Add
</code></pre></div><blockquote><p>Open打开工作簿</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Workbooks.Open (&quot;D:/BS.xlsx&quot;)
</code></pre></div><blockquote><p>OpenText打开文本</p> <ul><li>Filename : 文本文件名，必须</li> <li>其它参数参照帮助</li></ul></blockquote> <h2 id="_6-5-worksheet对象详细"><a href="#_6-5-worksheet对象详细" class="header-anchor">#</a> 6.5 Worksheet对象详细</h2> <h3 id="_6-5-1-worksheets方法"><a href="#_6-5-1-worksheets方法" class="header-anchor">#</a> 6.5.1 Worksheets方法</h3> <blockquote><p>Add : 新建工作表<br>
Copy : 复制工作表到工作簿的另一位置<br>
Delete : 删除集合中的指定工作表<br>
Move : 移动工作表到工作簿的其它位置
PrintOut : 打印输出工作表<br>
PrintPreview :  打印预览工作表</p></blockquote> <h3 id="_6-5-2-worksheet属性"><a href="#_6-5-2-worksheet属性" class="header-anchor">#</a> 6.5.2 Worksheet属性</h3> <blockquote><p>Cells : 返回Range对象，包含所有单元格<br>
Comments : 返回指定工作表的所有注释<br>
HPageBreaks/VPageBreaks : 工作表上的水平/垂直分页符
Name : 返回或设置工作表的名称<br>
Next : 返回后一个工作表<br>
Previous : 返回前一个工作表<br>
Range : 返回单元格或者单元格区域<br>
ScrollArea :  以A1样式的区域引用形式返回或设置允许滚动的区域<br>
UsedRange : 返回使用的区域<br>
Visible : 设置工作表是否可见</p></blockquote> <h3 id="_6-5-2-worksheet方法"><a href="#_6-5-2-worksheet方法" class="header-anchor">#</a> 6.5.2 Worksheet方法</h3> <blockquote><p>Activate : 激活工作表<br>
Copy : 复制工作表<br>
Delete : 删除工作表<br>
Move : 移动工作表到指定位置
Paste : 将剪贴板中的内容粘贴到工作表<br>
Protect : 保护工作表不被修改<br>
Unprotect : 解除受保护工作表的保护</p></blockquote> <h3 id="_6-5-3-worksheet事件"><a href="#_6-5-3-worksheet事件" class="header-anchor">#</a> 6.5.3 Worksheet事件</h3> <blockquote><p>Activate : 激活时触发<br>
BeforeDoubleClick : 双击时触发，先于默认的双击操作<br>
BeforeRightClick :  右击时触发，先于默认的右击操作<br>
Calculate : 工作表重新计算时发生此操作<br>
Change : 更改工作表中单元格或外链引起单元格的更改时发生
Deactivate : 图表或工作表被停用时触发<br>
SelectionChange :  选定区域改变时触发</p></blockquote> <h3 id="_6-5-4-运用"><a href="#_6-5-4-运用" class="header-anchor">#</a> 6.5.4 运用</h3> <blockquote><p>Add</p> <ul><li>Before : 指定工作表，新建工作表在此工作表之前</li> <li>After : 指定工作表，新建工作表在此工作表之后</li> <li>Count : 添加的工作表数</li> <li>Type : 工作表类型(xlWorksheet:工作表，xlChart(图表)，xlExcel4MacroSheet, xlExcel4IntlMacroSheet)</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Worksheets.Add(Before, After, Count, Type)
</code></pre></div><blockquote><p>Count/Activate/Delete/Previous/Next</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Dim c As Integer
c = Worksheets.Count
Worksheets(&quot;SheetBS&quot;).Activate
Worksheets(&quot;SheetBS&quot;).Delete
ActiveSheet.Previous.Activate
ActiveSheet.Next.Activate
</code></pre></div><blockquote><p>Protect/Unprotect详细参照帮助</p></blockquote> <blockquote><p>Shapes</p> <ul><li>msoAutoShape : 自选图形</li> <li>msoCallout : 标注</li> <li>msoCanvas : 画布</li> <li>msoChart : 图</li> <li>msoPicture : 图片</li> <li>...</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>'删除图片
Sub deletePicture()
 Dim p As Shape
 For Each p In ActiveSheet.Shapes
   If p.Type = msoPicture Then p.Delte
 Next
End Sub
</code></pre></div><blockquote><p>Hyperlinks处理超链接</p> <ul><li>Anchor : Object,超链接的位置，可以是Range或Shape对象</li> <li>Address : 超链接的地址</li> <li>SubAddress : 超链接的子地址</li> <li>ScreenTip : 鼠标悬停在链接上时显示的提示</li> <li>TextToDisplay : 超链接的文本</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>WorkSheet对象.Add(Anchor, Address, SubAddress, ScreenTip, TextToDisplay)
</code></pre></div><blockquote><p>删除超链接</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Sub deletHlinks()
  Dim h As Hyperlink, hs As Hyperlinks
  Set hs = ActiveSheet.Hyperlinks
  For Each h In hs
    h.Delete
  Next
End Sub
</code></pre></div><blockquote><p>其它操作</p> <ul><li>SelectionChange事件可禁止选中某个区域</li> <li>ScrollArea属性可设置滚动区域</li> <li>CountIf函数可禁止输入相同数据</li> <li>BeforeRightClick事件可增加右键菜单</li> <li>Deactivate事件可限制选择其它工作表</li> <li>Activate事件可隐藏工作表</li> <li>Interior指对象的内部，可用于设置对象内部的格式</li></ul></blockquote> <h2 id="_6-6-range对象详细"><a href="#_6-6-range对象详细" class="header-anchor">#</a> 6.6 Range对象详细</h2> <h3 id="_6-6-1-属性"><a href="#_6-6-1-属性" class="header-anchor">#</a> 6.6.1 属性</h3> <blockquote><p>ActiveCell : 当前工作表的活动单元格<br>
Address : 返回Range对象的引用地址<br>
Borders : 返回或设置表示样式或单元格区域的边框<br>
Characters : 返回文本内某个区域的字符，可为文本字符串内的字符设置格式<br>
Columns : 返回指定区域的列<br>
ColumnWidth : 返回或设置指定区域的列宽<br>
CurrentRegiaon : 返回当前区域<br>
End : 返回区域末端的单元格<br>
Font : 返回指定对象的字体<br>
Formula : 返回或设置单元格的公式<br>
HasFormula : 返回指定区域是否包含公式<br>
Height : 返回或设置单元格的高度<br>
NumberFormat : 返回或设置单元格的格式代码<br>
PrintArea : 设置打印区域<br>
Rows : 返回指定区域的行<br>
ScrollArea : 单元格滚动范围
Text : 返回或设置单元格中显示的文本<br>
Value : 返回指定单元格的值<br>
Width : 返回单元格的宽度</p></blockquote> <h3 id="_6-6-2-常用方法"><a href="#_6-6-2-常用方法" class="header-anchor">#</a> 6.6.2 常用方法</h3> <blockquote><p>Activate : 激活单元格<br>
AddComment : 添加批注(注释)<br>
AutoFormat : 自动套用格式<br>
AutoFit : 更改区域中的列宽或行高以达到最佳匹配<br>
Clear : 清除Range对象的中的内容<br>
ClearComments : 清除指定区域的所有单元格批注<br>
ClearContents : 清除区域中的公式<br>
ClearFormats : 清除对象的格式设置<br>
Copy : 将单元格区域复制到指定区域或剪切板中<br>
Delete : 删除指定的Range对象，xlShiftToLeft(左移), xlShiftUp(上移)
Find : 在区域中查找<br>
Insert : 插入单元格或区域<br>
Merge : 合并单元格<br>
PasteSpecial : 粘贴特殊内容，如公式、批注等<br>
Select : 选择单元格对象<br>
UnMerge : 取消合并单元格(拆分)</p></blockquote> <h3 id="_6-6-3-range对象引用"><a href="#_6-6-3-range对象引用" class="header-anchor">#</a> 6.6.3 Range对象引用</h3> <blockquote><p>单个单元格
多个单元格
整行或整列
[B2]</p></blockquote> <blockquote><p>使用A1样式引用</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Worksheets(&quot;sheetBS&quot;).Range(&quot;B9&quot;)
Worksheets(&quot;sheetBS&quot;).Range(&quot;A1:B5&quot;)
Worksheets(&quot;sheetBS&quot;).Range(&quot;B2:C5, D3:E6, A10:S12&quot;)
</code></pre></div><blockquote><p>使用Cells引用</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Cells(9, 12)
Cells(2, &quot;S&quot;)
</code></pre></div><blockquote><p>使用Offset
返回一个指定位置偏移位置上的区域</p> <ul><li>RowOffset : 行偏移，正数为下移，负数为上移，默认是0</li> <li>ColumnOffset : 列偏移，正数为右移，负数为左移，默认是0</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Offset(RowOffset, ColumnOffset)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Range(&quot;B2&quot;).Offset(, -5)
Range(&quot;S9&quot;).Offset(2, 2)
</code></pre></div><blockquote><p>整行/整行</p> <ul><li>EntireColumn : 整行</li> <li>EntireRow : 整列</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Range(&quot;B5&quot;).EntireColumn  '第2列
Range(&quot;B5&quot;).EntireRow  '第5行
</code></pre></div><blockquote><p>使用End</p> <ul><li>Direction : xlDown向下，xlToLeft向左，xlToRight向右，xlUp向上</li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Range对象.End(Direction)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Range(&quot;B9&quot;).End(xlUp).Select  '选中B9单元格中B列顶端的单元格
</code></pre></div><blockquote><p>CurrentRegion/UsedRange</p> <ul><li>CurrentRegion : 返回空行空列包围的区域</li> <li>UsedRange : 使用区域，行或者列里有单元格有被使用的区域，如果 AB两列和第1行没有任何单元格被使用，则返回的Range里没有AB两列和第1行</li></ul></blockquote> <blockquote><p>Intersect获取重叠区域引用<br>
该方法包含两个或多个重叠的矩形区域(2-30个)</p></blockquote> <blockquote><p>SpecialCells获取指定类型单元格<br>
返回与指定类型和值匹配的所有单元格</p> <ul><li>Type : 要包含的单元格
<ul><li>xlCellTypeAllFormatConditions : 含有条件格式的单元格</li> <li>xlCellTypeAllValidation : 含有验证条件的单元格</li> <li>xlCellTypeBlanks : 空单元格</li> <li>xlCellTypeComments : 含有注释的单元格</li> <li>xlCellTypeConstants : 含有常量的单元格</li> <li>xlCellTypeFormulas : 含有公式的单元格</li> <li>xlCellTypeLastCell : 已用区域的最后一个单元格</li> <li>xlCellTypeSameFormatConditions : 含有相同格式的单元格</li> <li>xlCellTypeSameValidation : 含有相同验证条件的单元格</li> <li>xlCellTypeVisible : 所有可见的单元格</li></ul></li> <li>Value : 可省略
<ul><li>xlErrors : 错误值</li> <li>xlLogical : 逻辑值</li> <li>xlNumbers : 数值</li> <li>xlTextValues : 文本</li></ul></li></ul></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Range对象.SpecialCells(Type, Value)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>'已用区域的最后一个单元格
ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell)
'设置了条件格式的单元格
ActiveSheet.Cells.SpecialCells(xlCellTypeAllFormatConditions)
</code></pre></div><blockquote><p>Areas引用合并区域的子区域
如需要操作合并区域的文本时</p></blockquote> <blockquote><p>Item引用区域内的单个单元格</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>'选定区域的第2行第3列
Range(&quot;B2:S9&quot;).Item(2,3)
Range(&quot;B2:S9&quot;)(2,3)
</code></pre></div><blockquote><p>追踪公式单元格</p> <ul><li>ShowPrecedents/ShowDependents ... 参照帮助</li></ul></blockquote> <h3 id="_6-6-4-行-列操作"><a href="#_6-6-4-行-列操作" class="header-anchor">#</a> 6.6.4 行/列操作</h3> <blockquote><p>Comment : 批注，可用相关属性方法进行操作，详细参照帮助<br>
ColumnWidth : 设置列宽<br>
Hidden : True则隐藏<br>
RowHeight : 返回或设置行高</p> <p>Insert</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Dim r As Long
r = Selecition.Row
ActiveSheet.Rows(r).Insert
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Dim c As Long
c = Selecition.Cloumn
ActiveSheet.Columns(c).Insert
</code></pre></div><blockquote><p>Delete</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Range(&quot;B2&quot;).EntireRow.Delete
</code></pre></div><h3 id="_6-6-5-单元格操作"><a href="#_6-6-5-单元格操作" class="header-anchor">#</a> 6.6.5 单元格操作</h3> <blockquote><p>CVErr函数 : Application函数，为单元格设置错误值<br>
IsError函数 : Application函数，判断错误类型<br>
HorizontalAlignment/VerticalAlignment : 设置文本对齐格式(水平方向、垂直方向)
InsertIndent : 返回或设置单元格文本缩进<br>
Orientation : 返回或设置文本方向(向下/水平/向上/向下居中/任意角度)<br>
WrapText : 返回或设置自动换行格式<br>
ShrinkToFit : 返回或设置缩小字体填充<br>
NumberFormatLocal : 设置日期格式，可用来生成大写金额<br>
Pattern : 返回或设置单元格内部图案<br>
PatternColor : 返回或设置单元格内部图案的颜色(RGB值)
FormatConditions : 设置条件格式(高于平均值条件、空值条件、色阶、错误条件等)</p></blockquote> <h2 id="_6-7-其它excel对象"><a href="#_6-7-其它excel对象" class="header-anchor">#</a> 6.7 其它Excel对象</h2> <h3 id="_6-7-1-name名称管理"><a href="#_6-7-1-name名称管理" class="header-anchor">#</a> 6.7.1 Name名称管理</h3> <blockquote><p>Names是名称对象的集合</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Names.Add Name:=&quot;nmBS&quot;, RefersTo:=&quot;sheetBS!$B$9:$S$12&quot;
</code></pre></div><h3 id="_6-7-2-window窗口对象"><a href="#_6-7-2-window窗口对象" class="header-anchor">#</a> 6.7.2 Window窗口对象</h3> <blockquote><p>EnableResize : True则可调整大小<br>
WindowSate : 窗口状态，最大化、最小化、正常<br>
SplitRow/SplitColumn : 拆分空格<br>
Zoom : 设置窗口显示比例<br>
DisplayHorizontalScrollBar : 水平滚动条<br>
DisplayVerticalScrollBar : 垂直滚动条<br>
DisplayWorkbooktabs : 工作表标签<br>
GridlineColor : 返回或设置网格颜色(RGB值)<br>
GridlineColorIndex : 返回或设置网格颜色(调色板中的索引)<br>
其它参照帮助</p></blockquote> <h3 id="_6-7-3-图表"><a href="#_6-7-3-图表" class="header-anchor">#</a> 6.7.3 图表</h3> <blockquote><p>Charts集合操作图表工作表<br>
ChartObjects操作工作表中的图表对象</p></blockquote> <blockquote><p>Chart方法</p> <ul><li>SetSourceData : 指定图表设置数据源区域</li> <li>Location : 转换图表类型</li> <li>ChartTitle : 获取图表标题</li> <li>SeriesCollection : 获取图表系列信息</li> <li>SetSourceData : 调整图表数据源</li> <li>CopyPicture : 将图表保存为图片</li></ul></blockquote> <blockquote><p>Chart事件
需要通过类模块来转换</p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最新提交时间:</span> <span class="time">6/20/2020, 2:12:04 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e981111c.js" defer></script><script src="/assets/js/2.d1d67354.js" defer></script><script src="/assets/js/22.69cad544.js" defer></script>
  </body>
</html>
