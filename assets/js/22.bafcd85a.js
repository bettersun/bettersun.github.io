(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{568:function(n,e,a){"use strict";a.r(e);var s=a(20),t=Object(s.a)({},(function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"windows-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-api"}},[n._v("#")]),n._v(" Windows API")]),n._v(" "),a("p",[a("strong",[n._v("一览")])]),n._v(" "),a("ul",[a("li",[n._v("关闭Excel进程")])]),n._v(" "),a("ul",[a("li")]),n._v(" "),a("h3",{attrs:{id:"关闭excel进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭excel进程"}},[n._v("#")]),n._v(" 关闭Excel进程")]),n._v(" "),a("blockquote",[a("p",[n._v("函数定义")])]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("'关闭Excel进程\n'API声明\nPrivate Declare Function PostMessage _\n    Lib \"user32.dll\" _\n    Alias \"PostMessageA\" ( _\n        ByVal hWnd As Long, _\n         ByVal wMsg As Long, _\n         ByVal wParam As Long, _\n         ByVal lParam As Long) _\nAs Long\nPrivate Const WM_CLOSE = &H10\n\n'关闭Excel进程\n'\n'  功能：\n'    Excel进程中只有当前文件时，关闭当前文件后，关闭Excel进程\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    If Application.Workbooks.Count = 1 Then\n        Call PostMessage(Application.hWnd, WM_CLOSE, 0, 0)\n    End If\nEnd Sub\n")])])])])}),[],!1,null,null,null);e.default=t.exports}}]);