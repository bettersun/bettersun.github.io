(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{560:function(e,t,a){"use strict";a.r(t);var s=a(20),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"_6-excel对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-excel对象"}},[e._v("#")]),e._v(" 6. Excel对象")]),e._v(" "),a("h2",{attrs:{id:"_6-1-集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-集合"}},[e._v("#")]),e._v(" 6.1 集合")]),e._v(" "),a("h3",{attrs:{id:"_6-1-1-集合对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-集合对象"}},[e._v("#")]),e._v(" 6.1.1 集合对象")]),e._v(" "),a("blockquote",[a("p",[e._v("Excel中有很多集合，代表一组相同的对象，例如：")]),e._v(" "),a("ul",[a("li",[e._v("Axes : 图表中所有坐标轴对象的集合")]),e._v(" "),a("li",[e._v("Workbooks : 所有打开的工作簿的集合")]),e._v(" "),a("li",[e._v("等等")])])]),e._v(" "),a("h3",{attrs:{id:"_6-1-2-集合引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-集合引用"}},[e._v("#")]),e._v(" 6.1.2 集合引用")]),e._v(" "),a("blockquote",[a("p",[e._v("用法：")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('集合("对象名称") 或者 集合(对象索引)\n')])])]),a("blockquote",[a("p",[e._v("例：")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Worksheets("sheetBS")\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Worksheets(1)\n")])])]),a("h3",{attrs:{id:"_6-1-3-集合属性、集合方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-3-集合属性、集合方法"}},[e._v("#")]),e._v(" 6.1.3 集合属性、集合方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Count属性"),a("br"),e._v("\nItem方法"),a("br"),e._v("\nAdd方法")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Dim cnt As Integer\ncnt = ActiveWorkbook.Worksheets.Count\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Dim wksheet As Object\nDim n As Integer\nn = 2\nSet wksheet = ActiveWorkbook.WorkSheets.Item(n)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Dim newSheet As Object\nSet newSheet = ActiveWorkbook.WorkSheets.Add("sheetBeyond")\n')])])]),a("h2",{attrs:{id:"_6-2-excel对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-excel对象"}},[e._v("#")]),e._v(" 6.2 Excel对象")]),e._v(" "),a("blockquote",[a("p",[e._v("可在VBE中使用对象浏览器(F2)查看对象成员")])]),e._v(" "),a("h3",{attrs:{id:"_6-2-1-application对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1-application对象"}},[e._v("#")]),e._v(" 6.2.1 Application对象")]),e._v(" "),a("blockquote",[a("p",[e._v("Application对象即Excel应用程序对象，该对象包括")])]),e._v(" "),a("blockquote",[a("ul",[a("li",[e._v("应用程序范围的设置和选项")]),e._v(" "),a("li",[e._v("返回顶级对象的方法，如ActiveSheet等")])])]),e._v(" "),a("h3",{attrs:{id:"_6-2-2-workbook对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-2-workbook对象"}},[e._v("#")]),e._v(" 6.2.2 Workbook对象")]),e._v(" "),a("blockquote",[a("p",[e._v("Workbook对象对应一个Excel工作簿\nWorkbook对象是Workbooks集合的成员\nThisWorkbook即运行VBA的工作簿，大多数情况是活动工作簿")])]),e._v(" "),a("h3",{attrs:{id:"_6-2-3-worksheet对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-3-worksheet对象"}},[e._v("#")]),e._v(" 6.2.3 Worksheet对象")]),e._v(" "),a("blockquote",[a("p",[e._v("Worksheet对象对应一个工作表\nWorksheet对象是Worksheets集合的成员，也是Sheets集合的成员")])]),e._v(" "),a("h3",{attrs:{id:"_6-2-4-range对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-4-range对象"}},[e._v("#")]),e._v(" 6.2.4 Range对象")]),e._v(" "),a("blockquote",[a("p",[e._v("Range为单元格对象，代表某一单元格、某一行、某一列、某一区域(连续或非连续)，或某一三维区域")])]),e._v(" "),a("blockquote",[a("p",[e._v("返回Range对象的属性和方法 ：")]),e._v(" "),a("ul",[a("li",[e._v("Worksheet对象的Range属性")]),e._v(" "),a("li",[e._v("Worksheet对象的Cells属性")]),e._v(" "),a("li",[e._v("Offset属性 : 已有Range对象的偏移区域")]),e._v(" "),a("li",[e._v("Union方法 : 两个或多个区域的合并区域")])])]),e._v(" "),a("h2",{attrs:{id:"_6-3-applcation对象详细"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-applcation对象详细"}},[e._v("#")]),e._v(" 6.3 Applcation对象详细")]),e._v(" "),a("h3",{attrs:{id:"_6-3-1-属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-1-属性"}},[e._v("#")]),e._v(" 6.3.1 属性")]),e._v(" "),a("blockquote",[a("p",[e._v("Caption : 返回或设置Excel应用程序标题栏的内容"),a("br"),e._v("\nCursor : 返回或设置鼠标指针状态"),a("br"),e._v("\nCellDragAndDrop : False则禁止拖动单元格\nDisplayAlerts : True则显示警告信息"),a("br"),e._v("\nDisplayFormulaBar : True则显示编辑栏"),a("br"),e._v("\nDiplayScrollBars : True则在所有工作簿中显示滚动条"),a("br"),e._v("\nDisplayStatusBar : True则显示状栏"),a("br"),e._v("\nRecentFiles : 显示最近使用的文档"),a("br"),e._v("\nScreenUpdating : True则开启屏幕更新"),a("br"),e._v("\nStatusBar : 返回或设置状态栏中的文字"),a("br"),e._v("\nVisible : 返回或设置Excel对象是否可见"),a("br"),e._v("\nWindowState : 返回或设置窗口的状态")])]),e._v(" "),a("blockquote",[a("p",[e._v("ActiveCell : 活动单元格"),a("br"),e._v("\nActiveChart : 活动图表"),a("br"),e._v("\nActiveSheet : 活动工作簿中的活动工作表"),a("br"),e._v("\nActiveWindow : 活动窗口"),a("br"),e._v("\nActiveWorkbook : 活动工作簿"),a("br"),e._v("\nCells : Range对象，可指定行和列"),a("br"),e._v("\nSelection : 活动窗口中选中的对象"),a("br"),e._v("\nSheets : 活动工作簿中的所有工作表"),a("br"),e._v("\nWorkbooks : 所有打开的工作簿"),a("br"),e._v("\nWorksheetFunction : 在VBA中调用Excel函数的容器")])]),e._v(" "),a("h3",{attrs:{id:"_6-3-2-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-2-方法"}},[e._v("#")]),e._v(" 6.3.2 方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Calculate : 计算指定区域中的单元格"),a("br"),e._v("\nEvaluate : 将一个Excel名称转换为一个对象或一个值"),a("br"),e._v("\nQuit : 退出Excel程序"),a("br"),e._v("\nOnKey : 自定义功能键\nOnTime : 在特定时间后执行一个过程"),a("br"),e._v("\nSendKeys : 模拟键盘输入"),a("br"),e._v("\nUndo : 撤销最后一次操作，不能撤销VBA执行的处理"),a("br"),e._v("\nUnion : 取得两个或多个区域的合并区域")])]),e._v(" "),a("h3",{attrs:{id:"_6-3-3-事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-3-事件"}},[e._v("#")]),e._v(" 6.3.3 事件")]),e._v(" "),a("blockquote",[a("p",[e._v("NewWorkbokk : 新建工作簿时触发"),a("br"),e._v("\nSheetAcitve : 激活任何工作表时触发"),a("br"),e._v("\nSheetBeforeDoubleClick : 双击任何工作表时触发，在实际双击操作前触发"),a("br"),e._v("\nSheetChange : 用户或外部链接更改了任何工作表中的单元格时触发"),a("br"),e._v("\nSheetDeactive : 任何工作表被停用时触发"),a("br"),e._v("\nWindowActive : 工作簿被激活时触发"),a("br"),e._v("\nWindowDeacitve : 任何工作簿被激活时触发"),a("br"),e._v("\nWindowResize : 任何工作簿窗口调整大小时触发"),a("br"),e._v("\nWorkbookActive : 激活任何工作簿时触发"),a("br"),e._v("\nWorkbookBeforeClose : 任何打开的工作簿关闭前触发"),a("br"),e._v("\nWorkbookBeforeSave : 保存任何工作簿之前触发"),a("br"),e._v("\nWorkbookNewSheet : 在工作簿中新建工作表时触发"),a("br"),e._v("\nWorkbookOpen : 打开工作簿时触发")])]),e._v(" "),a("h3",{attrs:{id:"_6-3-4-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-4-实例"}},[e._v("#")]),e._v(" 6.3.4 实例")]),e._v(" "),a("blockquote",[a("p",[e._v("鼠标指针")]),e._v(" "),a("ul",[a("li",[e._v("xlDefault : 默认指针")]),e._v(" "),a("li",[e._v("xlNorthwestArrow : 西北向箭头指针")]),e._v(" "),a("li",[e._v("xlWait : 沙漏型指针")]),e._v(" "),a("li",[e._v("xlIBeam : I型指针")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Sub testSub()\n  Application.Cursor = xlWait\n  ...\n  Application.Cursor = xlDefault\nEnd Sub\n")])])]),a("blockquote",[a("p",[e._v("屏幕刷新")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Sub testSub()\n  Application.ScreenUpdating = False  '不会实时显示处理中的画面改变\n  ...\n  Application.ScreenUpdating = True  '实时显示处理中的画面改变\n  ...\nEnd Sub\n")])])]),a("blockquote",[a("p",[e._v("DisplayAlerts控制警告信息")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Sub testSub()\n  Application.DisplayAlerts = False  '不会显示警告信息对话框\n  ...\n  Application.DisplayAlerts = True  '显示警告信息对话框\n  ...\nEnd Sub\n")])])]),a("blockquote",[a("p",[e._v("RecentsFiles显示最近使用的文档")]),e._v(" "),a("ul",[a("li",[e._v("Maximum : 返回或设置最近使用文件列表的文件数上限(0-9)")]),e._v(" "),a("li",[e._v("Count : 最近使用文件列表中文件的数量")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n\tDim f As RecentFile\n\t\n\tFor Each f In Application.RecentFiles\n\t  Debug.Pring "Recent File Name : " & f.Name\n\tNext\nEnd Sub\n')])])]),a("blockquote",[a("p",[e._v("用SendKeys方法模拟键盘输入")]),e._v(" "),a("ul",[a("li",[e._v("Keys : 以文本形式发送给应用程序的按键或组合键(Ctrl/Alt/Shift)"),a("br"),e._v("\n~ ：表示Enter键\n详细可参照帮助")]),e._v(" "),a("li",[e._v("Wait : True则等处理完按键后将控件返回给VBA，False则不等待继续运行VBA")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Application.SendKeys(Keys, Wait)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n\tDim valRtn As Double\n\tvalRtn = Shell("NOTEPAD.EXE", 1)  \'打开记事本\n\tAppActivate valRtn\n\tApplication.SendKeys "~", True  \'发送Enter回车\n\tApplication.SendKeys "Beyond Warrior", True  \'输入文本Beyond Warrior\nEnd Sub\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'激活选项卡\n\'激活 开始 选项卡(Alt + H)\nAppliction.SendKeys("%h")\n\'上述方法会显示快捷键提示, 可再按F6隐藏提示, 使用激活 开始 选项卡\nApplication.SendKeys("&h{F6}") \n')])])]),a("blockquote",[a("p",[e._v("OnTime定时执行")]),e._v(" "),a("ul",[a("li",[e._v("撤销定时运行需要将Schedule参数设置为False")]),e._v(" "),a("li",[e._v("如果找不到指定的过程会报错")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'20秒后执行过程testSub\nApplication.OnTime Now + TimeValue("00:00:20"), "testSub"\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'晚上10点执行过程shutdown\nApplication.OnTime TimeValue("22:00:00"), "shutdown"\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'撤销晚上10点执行过程shutdown\nApplication.OnTime EarliestTime:=TimeValue("22:00:00"), Procedure:="shutdown", Schedule:=False\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'整点报时\nSub showHour()\n  Application.OnTime EarliestTime:=TimeSerial((Hour(Now) + 1) Mod 24, 0, 0), Procedure:="showHour"\n  MsgBox "Now is " & Hour(now) & " hour."\nEnd Sub\n')])])]),a("blockquote",[a("p",[e._v("OnKey自定义功能键")]),e._v(" "),a("ul",[a("li",[e._v("Key : 按键的字符串，与SendKeys相同")]),e._v(" "),a("li",[e._v("Procedure : 要执行的过程名称的字符串，为空则不执行任何操作。省略则恢复Excel的默认设置")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Application.OnKey(Key, Procedure)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n  \' Alt + .执行subBeyond过程\n  Application.OnKey "%.", "subBeyond"\n  \' Alt + .不执行任何操作\n  Application.OnKey "%.", ""\n  \' 取消组合键Alt + .\n  Application.OnKey "%."\nEnd Sub\n')])])]),a("blockquote",[a("p",[e._v("WorksheetFunction调用内置函数")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n  Dim rng As Range\n  Dim sum As Integer\n  Set rng = ActiveSheet.Range("B2:D12")\n  sum = Application.WorksheetFunction.Sum(rng)\nEnd Sub\n')])])]),a("ul",[a("li",[e._v("WorksheetFunction.CountIf计算区域里满足条件的单元格的个数")])]),e._v(" "),a("blockquote",[a("p",[e._v("Goto跳转"),a("br"),e._v("\nGoto可以选择什么问题工作打开工作簿中的任意区域，该工作簿未处于活动状态时，则激活。该方法的Scroll属性，可让窗口滚动到指定位置")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n Application.Goto Reference:=Worksheets("sheetBS").Range("B9:S12"), Scroll:=True\nEnd Sub\n')])])]),a("blockquote",[a("p",[e._v("Union合并单元格")]),e._v(" "),a("ul",[a("li",[e._v("至少先择两个Range合并，最多可以合并30个Range")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Application.Union(rng1, rng2, ..., rng30)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Sub testSub()\n  Application.Union(Range("B9:C12"), Range("S10:V:20"))\n\nEnd Sub\n')])])]),a("blockquote",[a("p",[e._v("GetOpenFilename打开对话框打开文件")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Appliction.GetOpenFilename(FileFilter, FilterIndex, Title, ButtonText, MultiSelect)\n")])])]),a("blockquote",[a("p",[e._v("Application事件")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("'WorkbookBeforeSave事件\nPrivate Sub App_WorkbookBeforeSave(ByVal wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nEnd Sub\n")])])]),a("h2",{attrs:{id:"_6-4-workbook对象详细"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-workbook对象详细"}},[e._v("#")]),e._v(" 6.4 Workbook对象详细")]),e._v(" "),a("h3",{attrs:{id:"_6-4-1-属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-1-属性"}},[e._v("#")]),e._v(" 6.4.1 属性")]),e._v(" "),a("blockquote",[a("p",[e._v("AcitveSheet : 返回活动的工作表，没有则返回Nothing"),a("br"),e._v("\nApplication : 返回Excel程序"),a("br"),e._v("\nCharts : 返回工作簿中所有图表工作簿"),a("br"),e._v("\nBuiltinDocumentProperties : 内置文档属性集合"),a("br"),e._v("\nDocumentProperties : 文档属性集合\nFullName : 返回对象名称(包括路径)"),a("br"),e._v("\nName : 返回工作簿名称(不含路径)"),a("br"),e._v("\nNames : 返回所有名称对象"),a("br"),e._v("\nPassword : 返回工作簿密码(打开时用)"),a("br"),e._v("\nPath : 返回应用程序的完整路径"),a("br"),e._v("\nReadOnly : 返回工作簿是否以只读方式打开"),a("br"),e._v("\nSaved : 上次修改已保存，返回True;未保存返回False"),a("br"),e._v("\nSheets : 返回指定工作簿中的所有工作表的集合"),a("br"),e._v("\nWorkSheets : 返回指定工作簿中的所有工作表的集合"),a("br"),e._v("\nWindow : 返回指定工作簿中的所有窗口")])]),e._v(" "),a("h3",{attrs:{id:"_6-4-2-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-2-方法"}},[e._v("#")]),e._v(" 6.4.2 方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Activate : 激活工作簿相关的第一个窗口"),a("br"),e._v("\nChangeFileAccess : 更改工作簿的访问权限"),a("br"),e._v("\nClose : 关闭Workbook对象"),a("br"),e._v("\nProtect : 保护工作簿不被修改"),a("br"),e._v("\nSave : 保存工作簿的修改"),a("br"),e._v("\nSaveAs : 工作簿另存为"),a("br"),e._v("\nSaveCopyAs : 工作簿副本另存为"),a("br"),e._v("\nUnprotect : 对于受保护的工作簿或工作表， 取消工作簿或工作表的保护")])]),e._v(" "),a("h3",{attrs:{id:"_6-4-3-事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-3-事件"}},[e._v("#")]),e._v(" 6.4.3 事件")]),e._v(" "),a("blockquote",[a("p",[e._v("BeforeClose : 关闭工作簿前触发，若发生更改，在询问是否保存前触发"),a("br"),e._v("\nBeforePrint : 打印前触发"),a("br"),e._v("\nNewSheet : 新建工作表触发"),a("br"),e._v("\nOpen : 打开工作簿触发"),a("br"),e._v("\nSheetActivate : 激活任何工作表时触发"),a("br"),e._v("\nSheetDeactivate : 停用任何工作表时触发"),a("br"),e._v("\nWindowActivate : 工作簿窗口激活时触发"),a("br"),e._v("\nWindowDeacitvate : 停用任何工作簿窗口时触发"),a("br"),e._v("\nWindowResize : 任何工作簿窗口调整大小时触发")])]),e._v(" "),a("h3",{attrs:{id:"_6-4-4-workbooks集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-4-workbooks集合"}},[e._v("#")]),e._v(" 6.4.4 Workbooks集合")]),e._v(" "),a("blockquote",[a("p",[e._v("Add新建工作簿")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Workbooks.Add\n")])])]),a("blockquote",[a("p",[e._v("Open打开工作簿")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Workbooks.Open ("D:/BS.xlsx")\n')])])]),a("blockquote",[a("p",[e._v("OpenText打开文本")]),e._v(" "),a("ul",[a("li",[e._v("Filename : 文本文件名，必须")]),e._v(" "),a("li",[e._v("其它参数参照帮助")])])]),e._v(" "),a("h2",{attrs:{id:"_6-5-worksheet对象详细"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-worksheet对象详细"}},[e._v("#")]),e._v(" 6.5 Worksheet对象详细")]),e._v(" "),a("h3",{attrs:{id:"_6-5-1-worksheets方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-1-worksheets方法"}},[e._v("#")]),e._v(" 6.5.1 Worksheets方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Add : 新建工作表"),a("br"),e._v("\nCopy : 复制工作表到工作簿的另一位置"),a("br"),e._v("\nDelete : 删除集合中的指定工作表"),a("br"),e._v("\nMove : 移动工作表到工作簿的其它位置\nPrintOut : 打印输出工作表"),a("br"),e._v("\nPrintPreview :  打印预览工作表")])]),e._v(" "),a("h3",{attrs:{id:"_6-5-2-worksheet属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-2-worksheet属性"}},[e._v("#")]),e._v(" 6.5.2 Worksheet属性")]),e._v(" "),a("blockquote",[a("p",[e._v("Cells : 返回Range对象，包含所有单元格"),a("br"),e._v("\nComments : 返回指定工作表的所有注释"),a("br"),e._v("\nHPageBreaks/VPageBreaks : 工作表上的水平/垂直分页符\nName : 返回或设置工作表的名称"),a("br"),e._v("\nNext : 返回后一个工作表"),a("br"),e._v("\nPrevious : 返回前一个工作表"),a("br"),e._v("\nRange : 返回单元格或者单元格区域"),a("br"),e._v("\nScrollArea :  以A1样式的区域引用形式返回或设置允许滚动的区域"),a("br"),e._v("\nUsedRange : 返回使用的区域"),a("br"),e._v("\nVisible : 设置工作表是否可见")])]),e._v(" "),a("h3",{attrs:{id:"_6-5-2-worksheet方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-2-worksheet方法"}},[e._v("#")]),e._v(" 6.5.2 Worksheet方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Activate : 激活工作表"),a("br"),e._v("\nCopy : 复制工作表"),a("br"),e._v("\nDelete : 删除工作表"),a("br"),e._v("\nMove : 移动工作表到指定位置\nPaste : 将剪贴板中的内容粘贴到工作表"),a("br"),e._v("\nProtect : 保护工作表不被修改"),a("br"),e._v("\nUnprotect : 解除受保护工作表的保护")])]),e._v(" "),a("h3",{attrs:{id:"_6-5-3-worksheet事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-3-worksheet事件"}},[e._v("#")]),e._v(" 6.5.3 Worksheet事件")]),e._v(" "),a("blockquote",[a("p",[e._v("Activate : 激活时触发"),a("br"),e._v("\nBeforeDoubleClick : 双击时触发，先于默认的双击操作"),a("br"),e._v("\nBeforeRightClick :  右击时触发，先于默认的右击操作"),a("br"),e._v("\nCalculate : 工作表重新计算时发生此操作"),a("br"),e._v("\nChange : 更改工作表中单元格或外链引起单元格的更改时发生\nDeactivate : 图表或工作表被停用时触发"),a("br"),e._v("\nSelectionChange :  选定区域改变时触发")])]),e._v(" "),a("h3",{attrs:{id:"_6-5-4-运用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-4-运用"}},[e._v("#")]),e._v(" 6.5.4 运用")]),e._v(" "),a("blockquote",[a("p",[e._v("Add")]),e._v(" "),a("ul",[a("li",[e._v("Before : 指定工作表，新建工作表在此工作表之前")]),e._v(" "),a("li",[e._v("After : 指定工作表，新建工作表在此工作表之后")]),e._v(" "),a("li",[e._v("Count : 添加的工作表数")]),e._v(" "),a("li",[e._v("Type : 工作表类型(xlWorksheet:工作表，xlChart(图表)，xlExcel4MacroSheet, xlExcel4IntlMacroSheet)")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Worksheets.Add(Before, After, Count, Type)\n")])])]),a("blockquote",[a("p",[e._v("Count/Activate/Delete/Previous/Next")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Dim c As Integer\nc = Worksheets.Count\nWorksheets("SheetBS").Activate\nWorksheets("SheetBS").Delete\nActiveSheet.Previous.Activate\nActiveSheet.Next.Activate\n')])])]),a("blockquote",[a("p",[e._v("Protect/Unprotect详细参照帮助")])]),e._v(" "),a("blockquote",[a("p",[e._v("Shapes")]),e._v(" "),a("ul",[a("li",[e._v("msoAutoShape : 自选图形")]),e._v(" "),a("li",[e._v("msoCallout : 标注")]),e._v(" "),a("li",[e._v("msoCanvas : 画布")]),e._v(" "),a("li",[e._v("msoChart : 图")]),e._v(" "),a("li",[e._v("msoPicture : 图片")]),e._v(" "),a("li",[e._v("...")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("'删除图片\nSub deletePicture()\n Dim p As Shape\n For Each p In ActiveSheet.Shapes\n   If p.Type = msoPicture Then p.Delte\n Next\nEnd Sub\n")])])]),a("blockquote",[a("p",[e._v("Hyperlinks处理超链接")]),e._v(" "),a("ul",[a("li",[e._v("Anchor : Object,超链接的位置，可以是Range或Shape对象")]),e._v(" "),a("li",[e._v("Address : 超链接的地址")]),e._v(" "),a("li",[e._v("SubAddress : 超链接的子地址")]),e._v(" "),a("li",[e._v("ScreenTip : 鼠标悬停在链接上时显示的提示")]),e._v(" "),a("li",[e._v("TextToDisplay : 超链接的文本")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("WorkSheet对象.Add(Anchor, Address, SubAddress, ScreenTip, TextToDisplay)\n")])])]),a("blockquote",[a("p",[e._v("删除超链接")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Sub deletHlinks()\n  Dim h As Hyperlink, hs As Hyperlinks\n  Set hs = ActiveSheet.Hyperlinks\n  For Each h In hs\n    h.Delete\n  Next\nEnd Sub\n")])])]),a("blockquote",[a("p",[e._v("其它操作")]),e._v(" "),a("ul",[a("li",[e._v("SelectionChange事件可禁止选中某个区域")]),e._v(" "),a("li",[e._v("ScrollArea属性可设置滚动区域")]),e._v(" "),a("li",[e._v("CountIf函数可禁止输入相同数据")]),e._v(" "),a("li",[e._v("BeforeRightClick事件可增加右键菜单")]),e._v(" "),a("li",[e._v("Deactivate事件可限制选择其它工作表")]),e._v(" "),a("li",[e._v("Activate事件可隐藏工作表")]),e._v(" "),a("li",[e._v("Interior指对象的内部，可用于设置对象内部的格式")])])]),e._v(" "),a("h2",{attrs:{id:"_6-6-range对象详细"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-range对象详细"}},[e._v("#")]),e._v(" 6.6 Range对象详细")]),e._v(" "),a("h3",{attrs:{id:"_6-6-1-属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-1-属性"}},[e._v("#")]),e._v(" 6.6.1 属性")]),e._v(" "),a("blockquote",[a("p",[e._v("ActiveCell : 当前工作表的活动单元格"),a("br"),e._v("\nAddress : 返回Range对象的引用地址"),a("br"),e._v("\nBorders : 返回或设置表示样式或单元格区域的边框"),a("br"),e._v("\nCharacters : 返回文本内某个区域的字符，可为文本字符串内的字符设置格式"),a("br"),e._v("\nColumns : 返回指定区域的列"),a("br"),e._v("\nColumnWidth : 返回或设置指定区域的列宽"),a("br"),e._v("\nCurrentRegiaon : 返回当前区域"),a("br"),e._v("\nEnd : 返回区域末端的单元格"),a("br"),e._v("\nFont : 返回指定对象的字体"),a("br"),e._v("\nFormula : 返回或设置单元格的公式"),a("br"),e._v("\nHasFormula : 返回指定区域是否包含公式"),a("br"),e._v("\nHeight : 返回或设置单元格的高度"),a("br"),e._v("\nNumberFormat : 返回或设置单元格的格式代码"),a("br"),e._v("\nPrintArea : 设置打印区域"),a("br"),e._v("\nRows : 返回指定区域的行"),a("br"),e._v("\nScrollArea : 单元格滚动范围\nText : 返回或设置单元格中显示的文本"),a("br"),e._v("\nValue : 返回指定单元格的值"),a("br"),e._v("\nWidth : 返回单元格的宽度")])]),e._v(" "),a("h3",{attrs:{id:"_6-6-2-常用方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-2-常用方法"}},[e._v("#")]),e._v(" 6.6.2 常用方法")]),e._v(" "),a("blockquote",[a("p",[e._v("Activate : 激活单元格"),a("br"),e._v("\nAddComment : 添加批注(注释)"),a("br"),e._v("\nAutoFormat : 自动套用格式"),a("br"),e._v("\nAutoFit : 更改区域中的列宽或行高以达到最佳匹配"),a("br"),e._v("\nClear : 清除Range对象的中的内容"),a("br"),e._v("\nClearComments : 清除指定区域的所有单元格批注"),a("br"),e._v("\nClearContents : 清除区域中的公式"),a("br"),e._v("\nClearFormats : 清除对象的格式设置"),a("br"),e._v("\nCopy : 将单元格区域复制到指定区域或剪切板中"),a("br"),e._v("\nDelete : 删除指定的Range对象，xlShiftToLeft(左移), xlShiftUp(上移)\nFind : 在区域中查找"),a("br"),e._v("\nInsert : 插入单元格或区域"),a("br"),e._v("\nMerge : 合并单元格"),a("br"),e._v("\nPasteSpecial : 粘贴特殊内容，如公式、批注等"),a("br"),e._v("\nSelect : 选择单元格对象"),a("br"),e._v("\nUnMerge : 取消合并单元格(拆分)")])]),e._v(" "),a("h3",{attrs:{id:"_6-6-3-range对象引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-3-range对象引用"}},[e._v("#")]),e._v(" 6.6.3 Range对象引用")]),e._v(" "),a("blockquote",[a("p",[e._v("单个单元格\n多个单元格\n整行或整列\n[B2]")])]),e._v(" "),a("blockquote",[a("p",[e._v("使用A1样式引用")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Worksheets("sheetBS").Range("B9")\nWorksheets("sheetBS").Range("A1:B5")\nWorksheets("sheetBS").Range("B2:C5, D3:E6, A10:S12")\n')])])]),a("blockquote",[a("p",[e._v("使用Cells引用")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Cells(9, 12)\nCells(2, "S")\n')])])]),a("blockquote",[a("p",[e._v("使用Offset\n返回一个指定位置偏移位置上的区域")]),e._v(" "),a("ul",[a("li",[e._v("RowOffset : 行偏移，正数为下移，负数为上移，默认是0")]),e._v(" "),a("li",[e._v("ColumnOffset : 列偏移，正数为右移，负数为左移，默认是0")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Offset(RowOffset, ColumnOffset)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Range("B2").Offset(, -5)\nRange("S9").Offset(2, 2)\n')])])]),a("blockquote",[a("p",[e._v("整行/整行")]),e._v(" "),a("ul",[a("li",[e._v("EntireColumn : 整行")]),e._v(" "),a("li",[e._v("EntireRow : 整列")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Range("B5").EntireColumn  \'第2列\nRange("B5").EntireRow  \'第5行\n')])])]),a("blockquote",[a("p",[e._v("使用End")]),e._v(" "),a("ul",[a("li",[e._v("Direction : xlDown向下，xlToLeft向左，xlToRight向右，xlUp向上")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Range对象.End(Direction)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Range("B9").End(xlUp).Select  \'选中B9单元格中B列顶端的单元格\n')])])]),a("blockquote",[a("p",[e._v("CurrentRegion/UsedRange")]),e._v(" "),a("ul",[a("li",[e._v("CurrentRegion : 返回空行空列包围的区域")]),e._v(" "),a("li",[e._v("UsedRange : 使用区域，行或者列里有单元格有被使用的区域，如果 AB两列和第1行没有任何单元格被使用，则返回的Range里没有AB两列和第1行")])])]),e._v(" "),a("blockquote",[a("p",[e._v("Intersect获取重叠区域引用"),a("br"),e._v("\n该方法包含两个或多个重叠的矩形区域(2-30个)")])]),e._v(" "),a("blockquote",[a("p",[e._v("SpecialCells获取指定类型单元格"),a("br"),e._v("\n返回与指定类型和值匹配的所有单元格")]),e._v(" "),a("ul",[a("li",[e._v("Type : 要包含的单元格\n"),a("ul",[a("li",[e._v("xlCellTypeAllFormatConditions : 含有条件格式的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeAllValidation : 含有验证条件的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeBlanks : 空单元格")]),e._v(" "),a("li",[e._v("xlCellTypeComments : 含有注释的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeConstants : 含有常量的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeFormulas : 含有公式的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeLastCell : 已用区域的最后一个单元格")]),e._v(" "),a("li",[e._v("xlCellTypeSameFormatConditions : 含有相同格式的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeSameValidation : 含有相同验证条件的单元格")]),e._v(" "),a("li",[e._v("xlCellTypeVisible : 所有可见的单元格")])])]),e._v(" "),a("li",[e._v("Value : 可省略\n"),a("ul",[a("li",[e._v("xlErrors : 错误值")]),e._v(" "),a("li",[e._v("xlLogical : 逻辑值")]),e._v(" "),a("li",[e._v("xlNumbers : 数值")]),e._v(" "),a("li",[e._v("xlTextValues : 文本")])])])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Range对象.SpecialCells(Type, Value)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("'已用区域的最后一个单元格\nActiveSheet.Cells.SpecialCells(xlCellTypeLastCell)\n'设置了条件格式的单元格\nActiveSheet.Cells.SpecialCells(xlCellTypeAllFormatConditions)\n")])])]),a("blockquote",[a("p",[e._v("Areas引用合并区域的子区域\n如需要操作合并区域的文本时")])]),e._v(" "),a("blockquote",[a("p",[e._v("Item引用区域内的单个单元格")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\'选定区域的第2行第3列\nRange("B2:S9").Item(2,3)\nRange("B2:S9")(2,3)\n')])])]),a("blockquote",[a("p",[e._v("追踪公式单元格")]),e._v(" "),a("ul",[a("li",[e._v("ShowPrecedents/ShowDependents ... 参照帮助")])])]),e._v(" "),a("h3",{attrs:{id:"_6-6-4-行-列操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-4-行-列操作"}},[e._v("#")]),e._v(" 6.6.4 行/列操作")]),e._v(" "),a("blockquote",[a("p",[e._v("Comment : 批注，可用相关属性方法进行操作，详细参照帮助"),a("br"),e._v("\nColumnWidth : 设置列宽"),a("br"),e._v("\nHidden : True则隐藏"),a("br"),e._v("\nRowHeight : 返回或设置行高")]),e._v(" "),a("p",[e._v("Insert")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Dim r As Long\nr = Selecition.Row\nActiveSheet.Rows(r).Insert\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Dim c As Long\nc = Selecition.Cloumn\nActiveSheet.Columns(c).Insert\n")])])]),a("blockquote",[a("p",[e._v("Delete")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Range("B2").EntireRow.Delete\n')])])]),a("h3",{attrs:{id:"_6-6-5-单元格操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-5-单元格操作"}},[e._v("#")]),e._v(" 6.6.5 单元格操作")]),e._v(" "),a("blockquote",[a("p",[e._v("CVErr函数 : Application函数，为单元格设置错误值"),a("br"),e._v("\nIsError函数 : Application函数，判断错误类型"),a("br"),e._v("\nHorizontalAlignment/VerticalAlignment : 设置文本对齐格式(水平方向、垂直方向)\nInsertIndent : 返回或设置单元格文本缩进"),a("br"),e._v("\nOrientation : 返回或设置文本方向(向下/水平/向上/向下居中/任意角度)"),a("br"),e._v("\nWrapText : 返回或设置自动换行格式"),a("br"),e._v("\nShrinkToFit : 返回或设置缩小字体填充"),a("br"),e._v("\nNumberFormatLocal : 设置日期格式，可用来生成大写金额"),a("br"),e._v("\nPattern : 返回或设置单元格内部图案"),a("br"),e._v("\nPatternColor : 返回或设置单元格内部图案的颜色(RGB值)\nFormatConditions : 设置条件格式(高于平均值条件、空值条件、色阶、错误条件等)")])]),e._v(" "),a("h2",{attrs:{id:"_6-7-其它excel对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-其它excel对象"}},[e._v("#")]),e._v(" 6.7 其它Excel对象")]),e._v(" "),a("h3",{attrs:{id:"_6-7-1-name名称管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-1-name名称管理"}},[e._v("#")]),e._v(" 6.7.1 Name名称管理")]),e._v(" "),a("blockquote",[a("p",[e._v("Names是名称对象的集合")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Names.Add Name:="nmBS", RefersTo:="sheetBS!$B$9:$S$12"\n')])])]),a("h3",{attrs:{id:"_6-7-2-window窗口对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-2-window窗口对象"}},[e._v("#")]),e._v(" 6.7.2 Window窗口对象")]),e._v(" "),a("blockquote",[a("p",[e._v("EnableResize : True则可调整大小"),a("br"),e._v("\nWindowSate : 窗口状态，最大化、最小化、正常"),a("br"),e._v("\nSplitRow/SplitColumn : 拆分空格"),a("br"),e._v("\nZoom : 设置窗口显示比例"),a("br"),e._v("\nDisplayHorizontalScrollBar : 水平滚动条"),a("br"),e._v("\nDisplayVerticalScrollBar : 垂直滚动条"),a("br"),e._v("\nDisplayWorkbooktabs : 工作表标签"),a("br"),e._v("\nGridlineColor : 返回或设置网格颜色(RGB值)"),a("br"),e._v("\nGridlineColorIndex : 返回或设置网格颜色(调色板中的索引)"),a("br"),e._v("\n其它参照帮助")])]),e._v(" "),a("h3",{attrs:{id:"_6-7-3-图表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-3-图表"}},[e._v("#")]),e._v(" 6.7.3 图表")]),e._v(" "),a("blockquote",[a("p",[e._v("Charts集合操作图表工作表"),a("br"),e._v("\nChartObjects操作工作表中的图表对象")])]),e._v(" "),a("blockquote",[a("p",[e._v("Chart方法")]),e._v(" "),a("ul",[a("li",[e._v("SetSourceData : 指定图表设置数据源区域")]),e._v(" "),a("li",[e._v("Location : 转换图表类型")]),e._v(" "),a("li",[e._v("ChartTitle : 获取图表标题")]),e._v(" "),a("li",[e._v("SeriesCollection : 获取图表系列信息")]),e._v(" "),a("li",[e._v("SetSourceData : 调整图表数据源")]),e._v(" "),a("li",[e._v("CopyPicture : 将图表保存为图片")])])]),e._v(" "),a("blockquote",[a("p",[e._v("Chart事件\n需要通过类模块来转换")])])])}),[],!1,null,null,null);t.default=r.exports}}]);