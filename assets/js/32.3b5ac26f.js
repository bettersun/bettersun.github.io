(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{580:function(a,t,s){"use strict";s.r(t);var e=s(20),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"_4-过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-过程"}},[a._v("#")]),a._v(" 4. 过程")]),a._v(" "),s("h2",{attrs:{id:"_4-1-sub过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-sub过程"}},[a._v("#")]),a._v(" 4.1 Sub过程")]),a._v(" "),s("h3",{attrs:{id:"_4-1-1-定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-定义"}},[a._v("#")]),a._v(" 4.1.1 定义")]),a._v(" "),s("blockquote",[s("p",[a._v("Sub过程： 执行一系列处理，无返回值，可以被宏调用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[Public | Private | Friend] [Static] Sub 过程名称([参数列表])\n  语句\n  [Exit Sub]\n  语句\nEnd Sub\n")])])]),s("blockquote",[s("ul",[s("li",[a._v("Public/Private : 共有/私有")]),a._v(" "),s("li",[a._v("Friend : 类模块中使用，整个工程可见，对象实例不可见")]),a._v(" "),s("li",[a._v("Static : 调用后仍保留Sub局部变量的值")]),a._v(" "),s("li",[a._v("参数列表 : 参数之间以逗号隔开")])])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testSub(a As Integer, b As String)\n  MsgBox "a = " & a & " b = " & b \nEnd Sub\n')])])]),s("h3",{attrs:{id:"_4-1-2-调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-调用"}},[a._v("#")]),a._v(" 4.1.2 调用")]),a._v(" "),s("blockquote",[s("p",[a._v("1 使用Call调用，参数列表需要加括号"),s("br"),a._v("\n2 不使用Call调用，此时参数列表不可加括号")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Call 过程名称(参数列表)  \n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Call testSub(12, "BS")\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Call testSub2\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('testSub 12, "BS"\n')])])]),s("h2",{attrs:{id:"_4-2-function函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-function函数"}},[a._v("#")]),a._v(" 4.2 Function函数")]),a._v(" "),s("h3",{attrs:{id:"_4-2-1定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1定义"}},[a._v("#")]),a._v(" 4.2.1定义")]),a._v(" "),s("blockquote",[s("p",[a._v("Function函数： 执行一系列处理有返回值，需要在Sub中调用，不能被宏调用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[Public | Private | Friend] [Static] Function 函数名称([参数列表]) [As 返回结果类型]\n  语句\n  函数名称 = 返回结果\n  [Exit Function]\n  语句\n  函数名称 = 返回值结果\nEnd Function\n")])])]),s("blockquote",[s("ul",[s("li",[a._v("各结构与Sub过程类似")]),a._v(" "),s("li",[a._v("通过给函数名称赋值返回结果，如果不赋值，数值函数返回0，字符函数返回空字符串")])])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testFunction(a As Integer, b As String) As String\n  testFunction = "result : " & a & " " & b \nEnd Function\n')])])]),s("h3",{attrs:{id:"_4-2-2-调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-调用"}},[a._v("#")]),a._v(" 4.2.2 调用")]),a._v(" "),s("blockquote",[s("ol",[s("li",[a._v("在工作表使用【插入函数】中调用")]),a._v(" "),s("li",[a._v("在Sub过程或者Function函数中调用")])])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testSub(a As Integer, b As String)\n\tDim s As String\n\ts = testFunction(a, b)\n\t\n\tMsgBox "result : " & s\nEnd Sub\n')])])]),s("h2",{attrs:{id:"_4-3-参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-参数"}},[a._v("#")]),a._v(" 4.3 参数")]),a._v(" "),s("h3",{attrs:{id:"_4-3-1-参数传递"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-参数传递"}},[a._v("#")]),a._v(" 4.3.1 参数传递")]),a._v(" "),s("blockquote",[s("p",[a._v("定义:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Function testFunc(a1 As Integer, b2 As Integer, c3 As String)\n  ...\nEnd Function\n")])])]),s("blockquote",[s("p",[a._v("调用:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('\'直接调用，位置对应\ntestFunc 1, 2, "BS"\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('\'Call调用，位置对应\nCall testFunc(1, 2, "BS")\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('\'Call参数指定\nCall testFunc(a1:=1, b2:=2, c3:="BS")\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('\'Call参数指定\nCall testFunc(c3:="BS", a1:=1, b2:=2)\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('\'Call位置指定和参数指定混合，位置指定参数必须在最前面\nCall testFunc(1, b2:=2, c3:="BS")\n')])])]),s("h3",{attrs:{id:"_4-3-2-传递方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-传递方式"}},[a._v("#")]),a._v(" 4.3.2 传递方式")]),a._v(" "),s("blockquote",[s("p",[a._v("值传递，使用ByVal关键字, 传递的值会被复制一份，处理内部对参数的改变不影响调用外部变量的值")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testSub1(ByVal a As Integer)\n  a = a * 10\n  Debug.Print "sub1 : a = " & a\nEnd Sub\n\nSub testSub2()\n  Dim a As Integer\n  a = 12\n  Debug.Print "before : a = " & a\n  Call testSub1(a)\n  Debug.Print "after : a = " & a\nEnd Sub\n')])])]),s("blockquote",[s("ul",[s("li",[a._v("执行结果："),s("br"),a._v("\nbefore : a = 12"),s("br"),a._v("\nsub1 : a = 120"),s("br"),a._v("\nafter : a = 12")])])]),a._v(" "),s("p",[a._v("=")]),a._v(" "),s("blockquote",[s("p",[a._v("引用传递，VBA的默认传值方式，使用ByRef关键字，也可省略ByRef关键字。实际传递参数是表达式或者常量时，不能按引用传递参数")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testSub1(ByRef a As Integer)\n  a = a * 10\n  Debug.Print "sub1 : a = " & a\nEnd Sub\n\nSub testSub2()\n  Dim a As Integer\n  a = 12\n  Debug.Print "before : a = " & a\n  Call testSub1(a)\n  Debug.Print "after : a = " & a\nEnd Sub\n')])])]),s("blockquote",[s("ul",[s("li",[a._v("执行结果："),s("br"),a._v("\nbefore : a = 12"),s("br"),a._v("\nsub1 : a = 120"),s("br"),a._v("\nafter : a = 120")])])]),a._v(" "),s("h3",{attrs:{id:"_4-3-3-数组参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-数组参数"}},[a._v("#")]),a._v(" 4.3.3 数组参数")]),a._v(" "),s("blockquote",[s("p",[a._v("数组是引用传递")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Sub testSub1(s() As String)\n  Dim i As Integer\n  For i = 1 To UBound(s) - LBound(s)\n    Debug.Print "s(" & i & ") : " & i\n  Next i\nEnd Sub\n\nSub testSub2()\n  Dim s(3) As Integer\n  s(1) = "B"\n  s(2) = "S"\n  s(3) = "N"\n  \n  Call testSub1(s)\nEnd Sub\n')])])]),s("blockquote",[s("ul",[s("li",[a._v("执行结果："),s("br"),a._v("\ns(1) : B"),s("br"),a._v("\ns(2) : S"),s("br"),a._v("\ns(3) : N")])])]),a._v(" "),s("h3",{attrs:{id:"_4-3-4-可选参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-4-可选参数"}},[a._v("#")]),a._v(" 4.3.4 可选参数")]),a._v(" "),s("blockquote",[s("p",[a._v("参数前使用关键字Optional, 可选参数必须放在最后")])]),a._v(" "),s("p",[a._v("=")]),a._v(" "),s("blockquote",[s("p",[a._v("定义:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Function testFunc(a1 As Integer, b2 As Integer, Optional c3 As String)\n  ...\nEnd Function\n")])])]),s("blockquote",[s("p",[a._v("调用:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Call testFunc(1, 2)\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Call testFunc(1, 2, "BS")\n')])])]),s("h3",{attrs:{id:"_4-3-5-可变参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-5-可变参数"}},[a._v("#")]),a._v(" 4.3.5 可变参数")]),a._v(" "),s("blockquote",[s("p",[a._v("在最后一个参数前加上关键字ParamArray, 可接受任意个数个参数")]),a._v(" "),s("ul",[s("li",[a._v("不能与ByVal, ByRef或者Optional一起使用, 可省略实际传递参数")]),a._v(" "),s("li",[a._v("对应参数类型必须为Variant数组")])])]),a._v(" "),s("p",[a._v("=")]),a._v(" "),s("blockquote",[s("p",[a._v("定义:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Function testFunc(len As Integer, ParamArray num())\n  ...\nEnd Function\n")])])]),s("blockquote",[s("p",[a._v("调用:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Call testFunc(1)\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Call testFunc(1, 11, 12, 13, 14, 15, 16)\n")])])]),s("h2",{attrs:{id:"_4-4-递归"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-递归"}},[a._v("#")]),a._v(" 4.4 递归")]),a._v(" "),s("blockquote",[s("p",[a._v("递归： 过程或函数调用自身或者两个过程或函数互相调用")]),a._v(" "),s("ul",[s("li",[a._v("需要结束递归的条件")]),a._v(" "),s("li",[a._v("递归都可使用循环代替")]),a._v(" "),s("li",[a._v("内存使用较高")])])]),a._v(" "),s("p",[a._v("=")]),a._v(" "),s("blockquote",[s("p",[a._v("阶乘")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Function fac(ByVal n As Integer) As Integer\n  If n <= 1 Then\n    Return 1\n  End If\n  \n  Return fac(n - 1) * n\nEnd Function\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);