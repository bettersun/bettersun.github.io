(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{569:function(t,e,a){"use strict";a.r(e);var r=a(20),n=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"wscript-shell-执行bat-exe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wscript-shell-执行bat-exe"}},[t._v("#")]),t._v(" WScript.Shell 执行bat(exe)")]),t._v(" "),a("p",[a("strong",[t._v("一览")])]),t._v(" "),a("ul",[a("li",[t._v("执行命令字符串")]),t._v(" "),a("li",[t._v("执行系统程序")]),t._v(" "),a("li",[t._v("执行Bat文件")])]),t._v(" "),a("p",[a("strong",[t._v("相关链接")])]),t._v(" "),a("ol",[a("li",[a("p",[a("a",{attrs:{href:"http://blog.51cto.com/alany/1568375",target:"_blank",rel:"noopener noreferrer"}},[t._v("WScript.Shell对象的 run()和exec()函数使用详解"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://msdn.microsoft.com/zh-cn/library/d5fk67ky(en-us,VS.85).aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Run方法 - MSDN"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"http://blog.csdn.net/liuyukuan/article/details/5974517",target:"_blank",rel:"noopener noreferrer"}},[t._v("CMD命令"),a("OutboundLink")],1)])])]),t._v(" "),a("h3",{attrs:{id:"wscript-shell-run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wscript-shell-run"}},[t._v("#")]),t._v(" WScript.Shell.Run")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Run函数有三个参数：\n  第一个参数是你要执行的程序的路径，若路径中存在空格，记得要用""括起来。\n  如"""C:\\Program Files\\nn.exe"""的形式或者Chr(34)&"C:\\Program Files\\nn.exe"&Chr(34)的形式。\n  第二个参数是窗口的形式，0是在后台运行；1表示正常运行；2表示激活程序并且显示为最小化；3表示激活程序并且显示为最大化；一共有10个这样的参数如下表。\n  第三个参数是表示这个脚本是等待还是继续执行，如果设为了 true，脚本就会等待调用的程序退出后再向后执行。\n  其实，Run 做为函数，前面还有一个接受返回值的变量，一般来说如果返回为0，表示成功执行，如果不为0，则这个返回值就是错误代码，可以通过这个代码找出相应的错误。\n  另外，如果你使用 Exec 方法的时候，如果希望等待cmd中程序执行完后，再执行后面的语句，也可以通过下面的方法：\n  oExec.StdErr.ReadAll() 或者 oExec.StdOut.ReadAll()\n  道理上也应该好理解，要得到输出的信息，肯定要 cmd 执行完后才会有输出的。\n    \n 窗口风格:\n  0  隐藏一个窗口并激活另一个窗口。\n  1  激活并显示窗口。如果窗口处于最小化或最大化状态，则系统将其还原到原始大小和位置。第一次显示该窗口时，应用程序应指定此标志。\n  2  激活窗口并将其显示为最小化窗口。\n  3  激活窗口并将其显示为最大化窗口。\n  4  按最近的窗口大小和位置显示窗口。活动窗口保持活动状态。\n  5  激活窗口并按当前的大小和位置显示它。\n  6  最小化指定的窗口，并按照 Z 顺序激活下一个顶部窗口。\n  7  将窗口显示为最小化窗口。活动窗口保持活动状态。\n  8  将窗口显示为当前状态。活动窗口保持活动状态。\n  9  激活并显示窗口。如果窗口处于最小化或最大化状态，则系统将其还原到原始大小和位置。还原最小化窗口时，应用程序应指定此标志。\n  10  根据启动应用程序的程序状态来设置显示状态。\n')])])]),a("p",[t._v("上述内容参照（复制）"),a("a",{attrs:{href:"http://blog.51cto.com/alany/1568375",target:"_blank",rel:"noopener noreferrer"}},[t._v("相关链接1"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"执行命令字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行命令字符串"}},[t._v("#")]),t._v(" 执行命令字符串")]),t._v(" "),a("blockquote",[a("p",[t._v("VBA代码: 打开C盘，并执行dir命令")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Dim oShell\nSet oShell = WScript.CreateObject ("WScript.Shell")\n\'cmd /K 执行完后续命令后不关闭命令窗口\noShell.Run "cmd /K cd C:\\ & Dir" \nSet oShell = Nothing\n')])])]),a("h3",{attrs:{id:"执行系统程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行系统程序"}},[t._v("#")]),t._v(" 执行系统程序")]),t._v(" "),a("blockquote",[a("p",[t._v("VBA代码1"),a("br"),t._v("\n用记事本程序打开当前运行脚本的副本")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Set WshShell = WScript.CreateObject("WScript.Shell")\nWshShell.Run "%windir%\\notepad " & WScript.ScriptFullName\n')])])]),a("blockquote",[a("p",[t._v("VBA代码2"),a("br"),t._v("\n保存记事本关闭时返回的错误码")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Set WshShell = WScript.CreateObject("WScript.Shell")\nReturn = WshShell.Run("notepad " & WScript.ScriptFullName, 1, true)\n')])])]),a("h3",{attrs:{id:"执行bat文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行bat文件"}},[t._v("#")]),t._v(" 执行Bat文件")]),t._v(" "),a("blockquote",[a("p",[t._v("VBA代码"),a("br"),t._v("\n执行指定路径下的Bat文件")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Dim ws As Object\nSet ws = CreateObject("Wscript.Shell")\n\'参数2：1的情况下，以正常大小显示命令行窗口\n\'参数3：True的情况下，等命令行窗口执行完执行后续处理\nws.Run "cmd /c C:\\BS\\Study\\VBA\\bat\\test.bat", 1, True\nDMsgBox "CMD End"\n')])])]),a("blockquote",[a("p",[t._v("Bat文件")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('echo off\necho "BS"\npause\n')])])]),a("blockquote",[a("p",[t._v("执行结果（窗口大小有所调整）"),a("br"),t._v(" "),a("img",{attrs:{src:"pic/Bat%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C.png",alt:""}})])]),t._v(" "),a("blockquote",[a("p",[t._v("按任意键后才会弹出提示窗口"),a("br"),t._v(" "),a("img",{attrs:{src:"pic/Run%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C.png",alt:""}})])])])}),[],!1,null,null,null);e.default=n.exports}}]);