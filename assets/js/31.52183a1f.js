(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{577:function(t,e,n){"use strict";n.r(e);var a=n(20),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件"}},[t._v("#")]),t._v(" 文件")]),t._v(" "),n("p",[n("strong",[t._v("一览")])]),t._v(" "),n("ul",[n("li",[t._v("指定文字编码写入文件(无BOM头)")]),t._v(" "),n("li",[t._v("指定文字编码读取文件")])]),t._v(" "),n("ul",[n("li")]),t._v(" "),n("h3",{attrs:{id:"指定文字编码写入文件-无bom头"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指定文字编码写入文件-无bom头"}},[t._v("#")]),t._v(" 指定文字编码写入文件(无BOM头)")]),t._v(" "),n("blockquote",[n("p",[t._v("函数定义")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("'指定文字编码写入文件(无BOM头)\n'\n'  功能：\n'    UTF8编码写入文件(无BOM头)\n'    该方法需要前期绑定两个对象库\n'    Microsoft ADO Ext. 6.0 for DDL and Security\n'    Microsoft ActiveX Data Objects 2.7 Library\n'\n'  参数：\n'    fileName : 要写入的文件名,完整路径\n'    content : 写入内容\n'    chartset : 文字编码  默认：\"utf-8\" UTF8编码,小写\nPublic Function writeTextNoBom(ByVal fileName As String, ByVal content As String, Optional chartset as String = \"utf-8\")\n\n    Dim stream As New ADODB.stream\n    \n    stream.Open\n    stream.Type = adTypeText\n    stream.CharSet = chartset  'UTF8编码,小写\n    stream.WriteText content\n   \n    ' 尝试删除 UTF-8 BOM\n    stream.Position = 3 '跳过 BOM\n   \n    Dim BinaryStream As New ADODB.stream\n    BinaryStream.Type = adTypeBinary\n    BinaryStream.Mode = adModeReadWrite\n    BinaryStream.Open\n\n    ' Strips BOM (前3个字节)\n    stream.CopyTo BinaryStream\n    stream.Flush\n    stream.Close\n\n    BinaryStream.SaveToFile fileName, adSaveCreateOverWrite\n    BinaryStream.Flush\n    BinaryStream.Close\nEnd Function\n")])])]),n("h3",{attrs:{id:"指定文字编码读取文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指定文字编码读取文件"}},[t._v("#")]),t._v(" 指定文字编码读取文件")]),t._v(" "),n("blockquote",[n("p",[t._v("函数定义")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("'指定文字编码读取文件\n'\n'  功能：\n'    指定文字编码读取文件\n'    该方法需要前期绑定两个对象库\n'    Microsoft ADO Ext. 6.0 for DDL and Security\n'    Microsoft ActiveX Data Objects 2.7 Library\n'\n'  参数：\n'    fileName : 要读取的文件名,完整路径\n'    content : 写入内容\n'    chartset : 文字编码  默认：\"utf-8\" UTF8编码,小写\nPublic Function ReadText(ByVal fileName As String, Optional chartset as String = \"utf-8\") As String\n\n    Dim stream As Object\n    Set stream = CreateObject(\"adodb.stream\")\n    \n    Dim s As String\n    \n    stream.Type = 2  '2-文本模式读取，1-二进制模式\n    stream.Mode = 3  '3-读写,1-读，2-写\n    stream.charset = LCase(charset)  'utf-8; Ascii; gb2312; big5; gbk; shift-jis (小写)\n    \n    stream.Open\n    stream.LoadFromFile fileName\n    \n    s = stream.ReadText\n    stream.Close\n    \n    Set stream = Nothing\n    \n    ReadTextWithCharset = s\n\nEnd Function\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);